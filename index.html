<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel â€“ Registro de Chamados</title>
  <!-- CSS agora vem de /public/css/styles.css -->
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <div class="container">
    <h2>Painel de Chamados</h2>
    <p>Bem-vindo! Aqui vocÃª pode registrar e acompanhar os chamados de ambulÃ¢ncia.</p>
    <button onclick="logout()">Sair</button>
    <div id="chamados"></div>
  </div>

  <script type="module">
    import { auth, ouvirChamados } from "./src/firebase.js";

    function logout(){
      auth.signOut().then(()=> window.location.href = "/login.html");
    }

    auth.onAuthStateChanged(user=>{
      if(!user){
        window.location.href = "/login.html";
      } else {
        carregarChamados();
      }
    });

    function carregarChamados(){
      const lista = document.getElementById("chamados");
      lista.innerHTML = "<h3>Chamados em aberto:</h3>";

      ouvirChamados(dados=>{
        lista.innerHTML = "<h3>Chamados em aberto:</h3>";
        if(dados){
          Object.keys(dados).forEach(id=>{
            const chamado = dados[id];
            lista.innerHTML += `<p>ðŸš‘ ${chamado.descricao || "Sem descriÃ§Ã£o"} â€“ criado por ${chamado.createdBy}</p>`;
          });
        } else {
          lista.innerHTML += "<p>Nenhum chamado registrado.</p>";
        }
      });
    }
  </script>
</body>
</html>
